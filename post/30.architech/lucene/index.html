<!doctype html><html lang=zh-cn itemscope itemtype=http://schema.org/WebPage>
<head>
<meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<title>Lucene基础知识 - Justice的小站</title>
<meta name=renderer content="webkit">
<meta name=referrer content="no-referrer">
<meta name=viewport content="width=device-width,initial-scale=1,user-scalable=yes">
<meta name=MobileOptimized content="width">
<meta name=HandheldFriendly content="true">
<meta name=applicable-device content="pc,mobile">
<meta name=theme-color content="#f8f5ec">
<meta name=msapplication-navbutton-color content="#f8f5ec">
<meta name=apple-mobile-web-app-capable content="yes">
<meta name=apple-mobile-web-app-status-bar-style content="#f8f5ec">
<meta name=mobile-web-app-capable content="yes">
<meta name=author content="Justice">
<meta name=description content="Lucene基础知识 简介 Lucene 是一个基于 Java 的全文信息检索工具包，它不是一个完整的搜索应用程序，而是为你的应用程序提供索引和搜索功能。Lucene">
<meta name=keywords content="tech,it,blog">
<meta name=generator content="Hugo 0.88.1">
<link rel=canonical href=https://justice.bj.cn/post/30.architech/lucene/>
<link rel=icon href=/favicon.ico>
<link rel=stylesheet href=/sass/jane.min.59a446ca0f76fe2dfc772a3a0b7512965043b4433e3e0dcf5b8ebeede14fae0c.css integrity="sha256-WaRGyg92/i38dyo6C3USllBDtEM+Pg3PW46+7eFPrgw=" media=screen crossorigin=anonymous>
<meta property="og:title" content="Lucene基础知识">
<meta property="og:description" content="Lucene基础知识 简介 Lucene 是一个基于 Java 的全文信息检索工具包，它不是一个完整的搜索应用程序，而是为你的应用程序提供索引和搜索功能。Lucene">
<meta property="og:type" content="article">
<meta property="og:url" content="https://justice.bj.cn/post/30.architech/lucene/"><meta property="article:section" content="post">
<meta property="article:published_time" content="2022-05-21T21:27:53+08:00">
<meta property="article:modified_time" content="2022-05-21T21:27:53+08:00"><meta property="og:site_name" content="Justice的小站">
<meta itemprop=name content="Lucene基础知识">
<meta itemprop=description content="Lucene基础知识 简介 Lucene 是一个基于 Java 的全文信息检索工具包，它不是一个完整的搜索应用程序，而是为你的应用程序提供索引和搜索功能。Lucene"><meta itemprop=datePublished content="2022-05-21T21:27:53+08:00">
<meta itemprop=dateModified content="2022-05-21T21:27:53+08:00">
<meta itemprop=wordCount content="3972">
<meta itemprop=keywords content="architech,"><meta name=twitter:card content="summary">
<meta name=twitter:title content="Lucene基础知识">
<meta name=twitter:description content="Lucene基础知识 简介 Lucene 是一个基于 Java 的全文信息检索工具包，它不是一个完整的搜索应用程序，而是为你的应用程序提供索引和搜索功能。Lucene"><!--[if lte IE 9]><script src=https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js></script><![endif]--><!--[if lt IE 9]><script src=https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js></script>
<script src=https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js></script><![endif]-->
</head>
<body>
<div id=mobile-navbar class=mobile-navbar>
<div class=mobile-header-logo>
<a href=/ class=logo>Justice's Blog</a>
</div>
<div class=mobile-navbar-icon>
<span></span>
<span></span>
<span></span>
</div>
</div>
<nav id=mobile-menu class="mobile-menu slideout-menu">
<ul class=mobile-menu-list>
<li class=mobile-menu-item>
<a class=menu-item-link href=https://justice.bj.cn/>主页</a>
</li><li class=mobile-menu-item>
<a class=menu-item-link href=https://justice.bj.cn/post/>点滴</a>
</li><li class=mobile-menu-item>
<a class=menu-item-link href=https://justice.bj.cn/tags/>标签</a>
</li><li class=mobile-menu-item>
<a class=menu-item-link href=https://justice.bj.cn/categories/>分类</a>
</li><li class=mobile-menu-item>
<a class=menu-item-link href=http://passer-by.com/pacman/ rel=noopener target=_blank>
更多
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6 21.568 21.632 54.144 54.208 54.144 54.208C534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92.0.0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"/><path d="M841.152 457.152c-30.528.0-54.784 24.512-54.784 54.656V786.56H237.696V237.696h206.016c6.656.0 10.752.0 13.248.0 30.72.0 55.04-24.512 55.04-54.848C512 152.32 487.36 128 456.96 128H183.04C153.216 128 128 152.576 128 182.848c0 3.136.256 6.272.768 9.28C128.256 195.136 128 198.272 128 201.408v639.488c0 .064.0.192.0.256.0.128.0.192.0.32.0 30.528 24.512 54.784 54.784 54.784H829.76c6.592.0 9.728.0 11.712.0 28.736.0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344v-20.352V561.408v-49.28C896 481.792 871.424 457.152 841.152 457.152z"/></svg>
</i>
</a>
</li>
</ul>
</nav>
<link rel=stylesheet href=/lib/photoswipe/photoswipe.min.css>
<link rel=stylesheet href=/lib/photoswipe/default-skin/default-skin.min.css>
<div class=pswp tabindex=-1 role=dialog aria-hidden=true>
<div class=pswp__bg></div>
<div class=pswp__scroll-wrap>
<div class=pswp__container>
<div class=pswp__item></div>
<div class=pswp__item></div>
<div class=pswp__item></div>
</div>
<div class="pswp__ui pswp__ui--hidden">
<div class=pswp__top-bar>
<div class=pswp__counter></div>
<button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>
<div class=pswp__preloader>
<div class=pswp__preloader__icn>
<div class=pswp__preloader__cut>
<div class=pswp__preloader__donut></div>
</div>
</div>
</div>
</div>
<div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
<div class=pswp__share-tooltip></div>
</div>
<button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
</button>
<div class=pswp__caption>
<div class=pswp__caption__center></div>
</div>
</div>
</div>
</div>
<header id=header class="header container">
<div class=logo-wrapper>
<a href=/ class=logo>
Justice's Blog
</a>
</div>
<nav class=site-navbar>
<ul id=menu class=menu>
<li class=menu-item>
<a class=menu-item-link href=https://justice.bj.cn/>主页</a>
</li>
<li class=menu-item>
<a class=menu-item-link href=https://justice.bj.cn/post/>点滴</a>
</li>
<li class=menu-item>
<a class=menu-item-link href=https://justice.bj.cn/tags/>标签</a>
</li>
<li class=menu-item>
<a class=menu-item-link href=https://justice.bj.cn/categories/>分类</a>
</li>
<li class=menu-item>
<a class=menu-item-link href=http://passer-by.com/pacman/ rel=noopener target=_blank>
更多
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M623.36 272.96 473.216 423.04C467.2 429.056 467.072 438.656 472.896 444.416c0 0-6.72-6.656 1.6 1.6 21.568 21.632 54.144 54.208 54.144 54.208C534.464 506.048 544 505.856 550.016 499.904l150.08-150.144 67.328 66.432c9.024 8.96 27.456 4.544 30.4-8.96 19.968-92.608 46.656-227.52 46.656-227.52 6.848-34.496-16.192-56.704-49.92-49.92.0.0-134.656 26.816-227.328 46.784C560.32 178.048 556.352 182.272 554.752 187.136c-3.2 6.208-3.008 14.208 3.776 20.992L623.36 272.96z"/><path d="M841.152 457.152c-30.528.0-54.784 24.512-54.784 54.656V786.56H237.696V237.696h206.016c6.656.0 10.752.0 13.248.0 30.72.0 55.04-24.512 55.04-54.848C512 152.32 487.36 128 456.96 128H183.04C153.216 128 128 152.576 128 182.848c0 3.136.256 6.272.768 9.28C128.256 195.136 128 198.272 128 201.408v639.488c0 .064.0.192.0.256.0.128.0.192.0.32.0 30.528 24.512 54.784 54.784 54.784H829.76c6.592.0 9.728.0 11.712.0 28.736.0 52.928-22.976 54.464-51.968C896 843.264 896 842.304 896 841.344v-20.352V561.408v-49.28C896 481.792 871.424 457.152 841.152 457.152z"/></svg>
</i>
</a>
</li>
<li class=menu-item>
<a id=search-btn class="menu-item-link menu-item-search" href=#>
<i class=iconfont><svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" width="18" height="18" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M973.81454219 973.81454219a91.78207815 91.78207815.0 01-129.80999631.0L682.0297247 811.83972101a425.48527711 425.48527711.0 01-230.35931791 68.16531768 428.3346319 428.3346319.0 11428.3346319-428.3346319A425.48527711 425.48527711.0 01811.83972101 682.0297247l162.02961656 161.97482118a91.83687354 91.83687354.0 01-.05479538 129.80999631zm-522.1441354-828.1209266a305.97679241 305.97679241.0 100 611.95358361 305.97679241 305.97679241.0 000-611.95358361z"/></svg>
</i>
</a>
</li>
</ul>
</nav>
</header>
<div id=mobile-panel>
<main id=main class="main bg-llight">
<div class=content-wrapper>
<div id=content class="content container">
<article class="post bg-white">
<header class=post-header>
<h1 class=post-title>Lucene基础知识</h1>
<div class=post-meta>
<time datetime=2022-05-21 class=post-time>
2022-05-21 21:27:53
</time>
<div class=post-category>
<a href=https://justice.bj.cn/categories/architech/> architech </a>
</div>
<span id=busuanzi_container_page_pv>
| 阅读 <span id=busuanzi_value_page_pv></span>
</span>
</div>
</header>
<div class=post-toc id=post-toc>
<h2 class=post-toc-title>文章目录</h2>
<div class=post-toc-content>
<nav id=TableOfContents>
<ul>
<li><a href=#简介>简介</a></li>
<li><a href=#架构>架构</a></li>
<li><a href=#索引和搜索>索引和搜索</a></li>
<li><a href=#基本概念>基本概念</a></li>
<li><a href=#软件包>软件包</a></li>
<li><a href=#索引>索引</a>
<ul>
<li><a href=#索引类型>索引类型</a></li>
</ul>
</li>
<li><a href=#搜索文档>搜索文档</a></li>
<li><a href=#总结>总结</a></li>
<li><a href=#参考>参考</a></li>
</ul>
</nav>
</div>
</div>
<div class=post-content>
<h1 id=lucene基础知识>Lucene基础知识</h1>
<h2 id=简介>简介</h2>
<p>Lucene 是一个基于 Java 的全文信息检索工具包，它不是一个完整的搜索应用程序，而是为你的应用程序提供索引和搜索功能。Lucene 目前是 Apache Jakarta 家族中的一个开源项目。也是目前最为流行的基于 Java 开源全文检索工具包。</p>
<p>Lucene 能够为文本类型的数据建立索引，只要能把要索引的数据格式转化的文本的，Lucene 就能对你的文档进行索引和搜索。比如你要对一些 HTML 文档，PDF 文档进行索引的话你就首先需要把 HTML 文档和 PDF 文档转化成文本格式的，然后将转化后的内容交给 Lucene 进行索引，然后把创建好的索引文件保存到磁盘或者内存中，最后根据用户输入的查询条件在索引文件上进行查询。不指定要索引的文档的格式也使 Lucene 能够几乎适用于所有的搜索应用程序。</p>
<h2 id=架构>架构</h2>
<p><img src=https://www.ibm.com/developerworks/cn/java/j-lo-lucene1/fig001.jpg alt="图 1. 搜索应用程序和 Lucene 之间的关系"></p>
<h2 id=索引和搜索>索引和搜索</h2>
<p>全文检索的流程分为两大部分：索引、搜索：</p>
<ul>
<li>
<p>索引：采集数据&ndash;>构建<code>Document</code>对象&ndash;>分析文档（分词）&ndash;>创建索引。</p>
</li>
<li>
<p>搜索：即用户通过搜索界面&ndash;>创建查询&ndash;>执行搜索，搜索器从索引库搜索&ndash;>渲染搜索结果。</p>
</li>
</ul>
<ul>
<li>
<p><strong>索引</strong>（index）：是把源数据处理成非常方便查询的索引文件的过程。Lucene 采用的是一种称为<strong>反向索引</strong>（inverted index）的机制。反向索引就是说我们维护了一个词 / 短语表，对于这个表中的每个词 / 短语，都有一个链表描述了有哪些文档包含了这个词 / 短语。这样在用户输入查询条件的时候，就能非常快的得到搜索结果。</p>
</li>
<li>
<p><strong>搜索</strong>（search）：对文档建立好索引后，就可以在这些索引上面进行搜索了。搜索引擎首先会对搜索的关键词进行解析，然后再在建立好的索引上面进行查找，最终返回和用户输入的关键词相关联的文档。</p>
</li>
</ul>
<h2 id=基本概念>基本概念</h2>
<p>在深入解读Lucene之前，先了解下Lucene的几个基本概念，以及这几个概念背后隐藏的一些东西。</p>
<p><img src=https://raw.githubusercontent.com/ZhuZhengyi/notebook-images/master/2020/12/25-09-30-08-2020-03-14-17-54-55-image.png alt></p>
<ul>
<li>
<p><strong>Index（索引）</strong>： 类似数据库的表的概念，为一个文档收纳箱，你可以往内部塞入新的文档，或者从里面拿出文档，但如果你要修改里面的某个文档，则必须先拿出来修改后再塞回去。这个收纳箱可以塞入各种类型的文档，文档里的内容可以任意定义，Lucene都能对其进行索引。</p>
</li>
<li>
<p><strong>Term和Term Dictionary</strong>：Lucene中索引和搜索的最小单位，一个Field会由一个或多个Term组成，Term是由Field经过Analyzer（分词）产生。Term Dictionary即Term词典，是根据条件查找Term的基本索引。</p>
</li>
<li>
<p><strong>Segment</strong></p>
<p>一个Index会由一个或多个sub-index构成，sub-index被称为Segment。Lucene的Segment设计思想，与LSM类似但又有些不同，继承了LSM中数据写入的优点，但是在查询上只能提供近实时而非实时查询。</p>
</li>
</ul>
<p>Lucene中的数据写入会先写内存的一个Buffer（类似LSM的MemTable，但是不可读），当Buffer内数据到一定量后会被flush成一个Segment，每个Segment有自己独立的索引，可独立被查询，但数据永远不能被更改。这种模式避免了随机写，数据写入都是Batch和Append，能达到很高的吞吐量。Segment中写入的文档不可被修改，但可被删除，删除的方式也不是在文件内部原地更改，而是会由另外一个文件保存需要被删除的文档的DocID，保证数据文件不可被修改。Index的查询需要对多个Segment进行查询并对结果进行合并，还需要处理被删除的文档，为了对查询进行优化，Lucene会有策略对多个Segment进行合并，这点与LSM对SSTable的Merge类似。</p>
<h2 id=软件包>软件包</h2>
<p>Lucene 软件包的发布形式是一个 JAR 文件，下面我们分析一下这个 JAR 文件里面的主要的 JAVA 包，使读者对之有个初步的了解。</p>
<ul>
<li>
<p><code>org.apache.lucene.document</code>: 提供了一些为封装要索引的文档所需要的类，比如 Document, Field。这样，每一个文档最终被封装成了一个 Document 对象。</p>
</li>
<li>
<p><code>org.apache.lucene.analysis</code>: 对文档进行分词，因为文档在建立索引之前必须要进行分词，所以这个包的作用可以看成是为建立索引做准备工作。</p>
</li>
<li>
<p><code>org.apache.lucene.index</code>: 提供了一些类来协助创建索引以及对创建好的索引进行更新。这里面有两个基础的类：IndexWriter 和 IndexReader，其中 IndexWriter 是用来创建索引并添加文档到索引中的，IndexReader 是用来删除索引中的文档的。</p>
</li>
<li>
<p><code>org.apache.lucene.search</code>: 提供对在建立好的索引上进行搜索所需要的类。比如 IndexSearcher 和 Hits, IndexSearcher 定义了在指定的索引上进行搜索的方法，Hits 用来保存搜索得到的结果。</p>
</li>
</ul>
<h2 id=索引>索引</h2>
<p>为了对文档进行索引，Lucene 提供了五个基础的类，分别如下：</p>
<ul>
<li>
<p><strong>Document</strong>：用来描述文档的，一个 Document 对象由多个 Field 对象组成的。可以把一个 Document 对象想象成数据库中的一个记录，而每个 Field 对象就是记录的一个字段。</p>
</li>
<li>
<p><strong>Field</strong>：用来描述一个文档的某个属性的，比如一封电子邮件的标题和内容可以用两个 Field 对象分别描述。</p>
</li>
<li>
<p><strong>Analyzer</strong>：在一个文档被索引之前，首先需要对文档内容进行分词处理，这部分工作就是由 Analyzer 来做的。Analyzer 类是一个抽象类，它有多个实现。针对不同的语言和应用需要选择适合的 Analyzer。Analyzer 把分词后的内容交给 IndexWriter 来建立索引。</p>
</li>
<li>
<p><strong>IndexWriter</strong>：用来创建索引的一个核心的类，作用是把一个个的 Document 对象加到索引中来。</p>
</li>
<li>
<p><strong>Directory</strong>：代表索引的存储的位置。是一个抽象类，目前有两个实现：</p>
<ul>
<li>
<p><strong>FSDirectory</strong>： 表示一个存储在文件系统中的索引的位置；</p>
</li>
<li>
<p><strong>RAMDirectory</strong>：表示一个存储在内存当中的索引的位置。</p>
</li>
</ul>
</li>
</ul>
<p>熟悉了建立索引所需要的这些类后，我们就开始对某个目录下面的文本文件建立索引了。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span><span class=lnt>34
</span><span class=lnt>35
</span><span class=lnt>36
</span><span class=lnt>37
</span><span class=lnt>38
</span><span class=lnt>39
</span><span class=lnt>40
</span><span class=lnt>41
</span><span class=lnt>42
</span><span class=lnt>43
</span><span class=lnt>44
</span><span class=lnt>45
</span><span class=lnt>46
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=c1>// TxtFileIndexer.java
</span><span class=c1></span><span class=kn>package</span> <span class=nn>TestLucene</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>java.io.File</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>java.io.FileReader</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>java.io.Reader</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>java.util.Date</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>org.apache.lucene.analysis.Analyzer</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>org.apache.lucene.analysis.standard.StandardAnalyzer</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>org.apache.lucene.document.Document</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>org.apache.lucene.document.Field</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>org.apache.lucene.index.IndexWriter</span><span class=o>;</span> 
<span class=cm>/** 
</span><span class=cm>* This class demonstrate the process of creating index with Lucene 
</span><span class=cm>* for text files 
</span><span class=cm>*/</span> 
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>TxtFileIndexer</span> <span class=o>{</span> 
     <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span><span class=o>{</span> 
     <span class=c1>//indexDir is the directory that hosts Lucene&#39;s index files 
</span><span class=c1></span>     <span class=n>File</span>   <span class=n>indexDir</span> <span class=o>=</span> <span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=s>&#34;D:\\luceneIndex&#34;</span><span class=o>);</span> 
     <span class=c1>//dataDir is the directory that hosts the text files that to be indexed 
</span><span class=c1></span>     <span class=n>File</span>   <span class=n>dataDir</span>  <span class=o>=</span> <span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=s>&#34;D:\\luceneData&#34;</span><span class=o>);</span> 
     <span class=n>Analyzer</span> <span class=n>luceneAnalyzer</span> <span class=o>=</span> <span class=k>new</span> <span class=n>StandardAnalyzer</span><span class=o>();</span> 
     <span class=n>File</span><span class=o>[]</span> <span class=n>dataFiles</span>  <span class=o>=</span> <span class=n>dataDir</span><span class=o>.</span><span class=na>listFiles</span><span class=o>();</span> 
     <span class=n>IndexWriter</span> <span class=n>indexWriter</span> <span class=o>=</span> <span class=k>new</span> <span class=n>IndexWriter</span><span class=o>(</span><span class=n>indexDir</span><span class=o>,</span> <span class=n>luceneAnalyzer</span><span class=o>,</span> <span class=kc>true</span><span class=o>);</span> 
     <span class=kt>long</span> <span class=n>startTime</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Date</span><span class=o>().</span><span class=na>getTime</span><span class=o>();</span> 
     <span class=c1>//遍历数据文件目录
</span><span class=c1></span>     <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>dataFiles</span><span class=o>.</span><span class=na>length</span><span class=o>;</span> <span class=n>i</span><span class=o>++){</span> 
          <span class=c1>//依次处理
</span><span class=c1></span>          <span class=k>if</span><span class=o>(</span><span class=n>dataFiles</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=na>isFile</span><span class=o>()</span> <span class=o>&amp;&amp;</span> <span class=n>dataFiles</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=na>getName</span><span class=o>().</span><span class=na>endsWith</span><span class=o>(</span><span class=s>&#34;.txt&#34;</span><span class=o>)){</span>
               <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;Indexing file &#34;</span> <span class=o>+</span> <span class=n>dataFiles</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=na>getCanonicalPath</span><span class=o>());</span> 
               <span class=n>Document</span> <span class=n>document</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Document</span><span class=o>();</span> 
               <span class=n>Reader</span> <span class=n>txtReader</span> <span class=o>=</span> <span class=k>new</span> <span class=n>FileReader</span><span class=o>(</span><span class=n>dataFiles</span><span class=o>[</span><span class=n>i</span><span class=o>]);</span> 
               <span class=n>document</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>Field</span><span class=o>.</span><span class=na>Text</span><span class=o>(</span><span class=s>&#34;path&#34;</span><span class=o>,</span><span class=n>dataFiles</span><span class=o>[</span><span class=n>i</span><span class=o>].</span><span class=na>getCanonicalPath</span><span class=o>()));</span> 
               <span class=n>document</span><span class=o>.</span><span class=na>add</span><span class=o>(</span><span class=n>Field</span><span class=o>.</span><span class=na>Text</span><span class=o>(</span><span class=s>&#34;contents&#34;</span><span class=o>,</span><span class=n>txtReader</span><span class=o>));</span> 
               <span class=n>indexWriter</span><span class=o>.</span><span class=na>addDocument</span><span class=o>(</span><span class=n>document</span><span class=o>);</span> 
          <span class=o>}</span> 
     <span class=o>}</span> 
     <span class=n>indexWriter</span><span class=o>.</span><span class=na>optimize</span><span class=o>();</span> 
     <span class=n>indexWriter</span><span class=o>.</span><span class=na>close</span><span class=o>();</span> 
     <span class=kt>long</span> <span class=n>endTime</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Date</span><span class=o>().</span><span class=na>getTime</span><span class=o>();</span> 

     <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;It takes &#34;</span> <span class=o>+</span> <span class=o>(</span><span class=n>endTime</span> <span class=o>-</span> <span class=n>startTime</span><span class=o>)</span> 
         <span class=o>+</span> <span class=s>&#34; milliseconds to create index for the files in directory &#34;</span>
         <span class=o>+</span> <span class=n>dataDir</span><span class=o>.</span><span class=na>getPath</span><span class=o>());</span>        
     <span class=o>}</span> 
<span class=o>}</span>
</code></pre></td></tr></table>
</div>
</div><p>IndexWriter 的构造函数需要三个参数:</p>
<ul>
<li>
<p>第一个参数：指定所创建的索引要存放的位置，他可以是一个 File 对象，也可以是一个 FSDirectory 对象或者 RAMDirectory 对象。</p>
</li>
<li>
<p>第二个参数：指定 Analyzer 类的一个实现，也就是指定这个索引是用哪个分词器对文挡内容进行分词。</p>
</li>
<li>
<p>第三个参数：是一个布尔型的变量，如果为 true 的话就代表创建一个新的索引，为 false 的话就代表在原来索引的基础上进行操作。</p>
</li>
</ul>
<h3 id=索引类型>索引类型</h3>
<p>Lucene中支持丰富的字段类型，每种字段类型确定了支持的数据类型以及索引方式，目前支持的字段类型包括LongPoint、TextField、StringField、NumericDocValuesField等。</p>
<p><img src=/Users/zhuzhengyi/tmp/gitnote-img/2020-03-14-18-01-33-image.png alt=loading-ag-13820></p>
<h2 id=搜索文档>搜索文档</h2>
<p>利用 Lucene 进行搜索就像建立索引一样也是非常方便的。Lucene 提供了几个基础的类来完成这个过程：</p>
<ul>
<li>
<p><strong>Query</strong>: 一个抽象类，有多个实现，比如 TermQuery, BooleanQuery, PrefixQuery. 这个类的目的是把用户输入的查询字符串封装成 Lucene 能够识别的 Query。</p>
</li>
<li>
<p><strong>Term</strong>: Term 是搜索的基本单位，一个 Term 对象有两个 String 类型的域组成。生成一个 Term 对象可以有如下一条语句来完成：Term term = new Term(“fieldName”,”queryWord”); 其中第一个参数代表了要在文档的哪一个 Field 上进行查找，第二个参数代表了要查询的关键词。</p>
</li>
<li>
<p><strong>TermQuery</strong>: TermQuery 是抽象类 Query 的一个子类，它同时也是 Lucene 支持的最为基本的一个查询类。生成一个 TermQuery 对象由如下语句完成： TermQuery termQuery = new TermQuery(new Term(“fieldName”,”queryWord”)); 它的构造函数只接受一个参数，那就是一个 Term 对象。</p>
</li>
<li>
<p><strong>IndexSearcher</strong>: IndexSearcher 是用来在建立好的索引上进行搜索的。它只能以只读的方式打开一个索引，所以可以有多个 IndexSearcher 的实例在一个索引上进行操作。</p>
</li>
<li>
<p><strong>Hits</strong>: Hits 是用来保存搜索的结果的。</p>
</li>
</ul>
<p>介绍完这些搜索所必须的类之后，我们就开始在之前所建立的索引上进行搜索了，清单 2 给出了完成搜索功能所需要的代码。</p>
<div class=highlight><div class=chroma>
<table class=lntable><tr><td class=lntd>
<pre tabindex=0 class=chroma><code><span class=lnt> 1
</span><span class=lnt> 2
</span><span class=lnt> 3
</span><span class=lnt> 4
</span><span class=lnt> 5
</span><span class=lnt> 6
</span><span class=lnt> 7
</span><span class=lnt> 8
</span><span class=lnt> 9
</span><span class=lnt>10
</span><span class=lnt>11
</span><span class=lnt>12
</span><span class=lnt>13
</span><span class=lnt>14
</span><span class=lnt>15
</span><span class=lnt>16
</span><span class=lnt>17
</span><span class=lnt>18
</span><span class=lnt>19
</span><span class=lnt>20
</span><span class=lnt>21
</span><span class=lnt>22
</span><span class=lnt>23
</span><span class=lnt>24
</span><span class=lnt>25
</span><span class=lnt>26
</span><span class=lnt>27
</span><span class=lnt>28
</span><span class=lnt>29
</span><span class=lnt>30
</span><span class=lnt>31
</span><span class=lnt>32
</span><span class=lnt>33
</span></code></pre></td>
<td class=lntd>
<pre tabindex=0 class=chroma><code class=language-java data-lang=java><span class=kn>package</span> <span class=nn>TestLucene</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>java.io.File</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>org.apache.lucene.document.Document</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>org.apache.lucene.index.Term</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>org.apache.lucene.search.Hits</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>org.apache.lucene.search.IndexSearcher</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>org.apache.lucene.search.TermQuery</span><span class=o>;</span> 
<span class=kn>import</span> <span class=nn>org.apache.lucene.store.FSDirectory</span><span class=o>;</span> 
<span class=cm>/** 
</span><span class=cm>* This class is used to demonstrate the 
</span><span class=cm>* process of searching on an existing 
</span><span class=cm>* Lucene index 
</span><span class=cm>*/</span> 
<span class=kd>public</span> <span class=kd>class</span> <span class=nc>TxtFileSearcher</span> <span class=o>{</span> 
    <span class=kd>public</span> <span class=kd>static</span> <span class=kt>void</span> <span class=nf>main</span><span class=o>(</span><span class=n>String</span><span class=o>[]</span> <span class=n>args</span><span class=o>)</span> <span class=kd>throws</span> <span class=n>Exception</span><span class=o>{</span> 
       <span class=n>String</span> <span class=n>queryStr</span> <span class=o>=</span> <span class=s>&#34;lucene&#34;</span><span class=o>;</span> 
       <span class=c1>//This is the directory that hosts the Lucene index 
</span><span class=c1></span>       <span class=n>File</span> <span class=n>indexDir</span> <span class=o>=</span> <span class=k>new</span> <span class=n>File</span><span class=o>(</span><span class=s>&#34;D:\\luceneIndex&#34;</span><span class=o>);</span> 
       <span class=n>FSDirectory</span> <span class=n>directory</span> <span class=o>=</span> <span class=n>FSDirectory</span><span class=o>.</span><span class=na>getDirectory</span><span class=o>(</span><span class=n>indexDir</span><span class=o>,</span><span class=kc>false</span><span class=o>);</span> 
       <span class=n>IndexSearcher</span> <span class=n>searcher</span> <span class=o>=</span> <span class=k>new</span> <span class=n>IndexSearcher</span><span class=o>(</span><span class=n>directory</span><span class=o>);</span> 
       <span class=k>if</span><span class=o>(!</span><span class=n>indexDir</span><span class=o>.</span><span class=na>exists</span><span class=o>()){</span> 
            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;The Lucene index is not exist&#34;</span><span class=o>);</span> 
            <span class=k>return</span><span class=o>;</span> 
       <span class=o>}</span> 
       <span class=n>Term</span> <span class=n>term</span> <span class=o>=</span> <span class=k>new</span> <span class=n>Term</span><span class=o>(</span><span class=s>&#34;contents&#34;</span><span class=o>,</span><span class=n>queryStr</span><span class=o>.</span><span class=na>toLowerCase</span><span class=o>());</span> 
       <span class=n>TermQuery</span> <span class=n>luceneQuery</span> <span class=o>=</span> <span class=k>new</span> <span class=n>TermQuery</span><span class=o>(</span><span class=n>term</span><span class=o>);</span> 
       <span class=n>Hits</span> <span class=n>hits</span> <span class=o>=</span> <span class=n>searcher</span><span class=o>.</span><span class=na>search</span><span class=o>(</span><span class=n>luceneQuery</span><span class=o>);</span> 
       <span class=k>for</span><span class=o>(</span><span class=kt>int</span> <span class=n>i</span> <span class=o>=</span> <span class=n>0</span><span class=o>;</span> <span class=n>i</span> <span class=o>&lt;</span> <span class=n>hits</span><span class=o>.</span><span class=na>length</span><span class=o>();</span> <span class=n>i</span><span class=o>++){</span> 
            <span class=n>Document</span> <span class=n>document</span> <span class=o>=</span> <span class=n>hits</span><span class=o>.</span><span class=na>doc</span><span class=o>(</span><span class=n>i</span><span class=o>);</span> 
            <span class=n>System</span><span class=o>.</span><span class=na>out</span><span class=o>.</span><span class=na>println</span><span class=o>(</span><span class=s>&#34;File: &#34;</span> <span class=o>+</span> <span class=n>document</span><span class=o>.</span><span class=na>get</span><span class=o>(</span><span class=s>&#34;path&#34;</span><span class=o>));</span> 
       <span class=o>}</span> 
    <span class=o>}</span> 
<span class=o>}</span>
</code></pre></td></tr></table>
</div>
</div><p>在清单 2 中，类 IndexSearcher 的构造函数接受一个类型为 Directory 的对象，Directory 是一个抽象类，它目前有两个子类：FSDirctory 和 RAMDirectory. 我们的程序中传入了一个 FSDirctory 对象作为其参数，代表了一个存储在磁盘上的索引的位置。构造函数执行完成后，代表了这个 IndexSearcher 以只读的方式打开了一个索引。然后我们程序构造了一个 Term 对象，通过这个 Term 对象，我们指定了要在文档的内容中搜索包含关键词”lucene”的文档。接着利用这个 Term 对象构造出 TermQuery 对象并把这个 TermQuery 对象传入到 IndexSearcher 的 search 方法中进行查询，返回的结果保存在 Hits 对象中。最后我们用了一个循环语句把搜索到的文档的路径都打印了出来。 好了，我们的搜索应用程序已经开发完毕，怎么样，利用 Lucene 开发搜索应用程序是不是很简单。</p>
<p>全文检索和数据库应用最大的不同在于：让最相关的头100条结果满足98%以上用户的需求</p>
<p>Lucene的创新之处：</p>
<p>大部分的搜索（数据库）引擎都是用B树结构来维护索引，索引的更新会导致大量的IO操作，Lucene在实现中，对此稍微有所改进：不是维护一个索引文件，而是在扩展索引的时候不断创建新的索引文件，然后定期的把这些新的小索引文件合并到原先的大索引中（针对不同的更新策略，批次的大小可以调整），这样在不影响检索的效率的前提下，提高了索引的效率。</p>
<h2 id=总结>总结</h2>
<p>本文首先介绍了 Lucene 的一些基本概念，然后开发了一个应用程序演示了利用 Lucene 建立索引并在该索引上进行搜索的过程。希望本文能够为学习 Lucene 的读者提供帮助。j</p>
<h2 id=参考>参考</h2>
<ol>
<li>
<p><a href=https://zhuanlan.zhihu.com/p/35469104>https://zhuanlan.zhihu.com/p/35469104</a></p>
</li>
<li>
<p><a href=https://www.infoq.cn/article/ejEG02VRoeGVaLw4j_LL>Lucene 查询原理及解析-InfoQ</a></p>
</li>
<li></li>
</ol>
</div>
<div class=post-copyright>
<p class=copyright-item>
<span class=item-title>文章作者</span>
<span class=item-content>Justice</span>
</p>
<p class=copyright-item>
<span class=item-title>上次更新</span>
<span class=item-content>
2022-05-21 21:27:53
</span>
</p>
<p class=copyright-item>
<span class=item-title>许可协议</span>
<span class=item-content><a rel="license noopener" href=https://creativecommons.org/licenses/by-nc-nd/4.0/ target=_blank>CC BY-NC-ND 4.0</a></span>
</p>
</div>
<div class=post-reward>
<input type=checkbox name=reward id=reward hidden>
<label class=reward-button for=reward>赞赏支持</label>
<div class=qr-code>
<label class=qr-code-image for=reward>
<img class=image src=/image/wx_reward_qrcode.png>
<span>微信打赏</span>
</label>
<label class=qr-code-image for=reward>
<img class=image src=/image/alipay_reward_qrcode.png>
<span>支付宝打赏</span>
</label>
<label class=qr-code-image for=reward>
<img class=image src=/image/bitcoin_reward_qrcode.png>
<span>比特币打赏</span>
</label>
</div>
</div>
<footer class=post-footer>
<div class=post-tags>
<a href=https://justice.bj.cn/tags/architech/>architech</a>
</div>
<nav class=post-nav>
<a class=prev href=/post/32.cloudnative/linux%E7%BD%91%E7%BB%9C%E5%91%BD%E5%90%8D%E7%A9%BA%E9%97%B4/>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M691.908486 949.511495l75.369571-89.491197c10.963703-12.998035 10.285251-32.864502-1.499144-44.378743L479.499795 515.267417l277.93508-310.326815c11.338233-12.190647 11.035334-32.285311-.638543-44.850487l-80.46666-86.564541c-11.680017-12.583596-30.356378-12.893658-41.662889-.716314L257.233596 494.235404c-11.332093 12.183484-11.041474 32.266891.657986 44.844348l80.46666 86.564541c1.772366 1.910513 3.706415 3.533476 5.750981 4.877077l306.620399 321.703933C662.505829 963.726242 680.945807 962.528973 691.908486 949.511495z"/></svg>
</i>
<span class="prev-text nav-default">Linux网络命名空间</span>
<span class="prev-text nav-mobile">上一篇</span>
</a>
<a class=next href=/post/12.data_struct/tree/masstree/>
<span class="next-text nav-default">MassTree</span>
<span class="prev-text nav-mobile">下一篇</span>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="18" height="18"><path d="M332.091514 74.487481l-75.369571 89.491197c-10.963703 12.998035-10.285251 32.864502 1.499144 44.378743l286.278095 300.375162L266.565125 819.058374c-11.338233 12.190647-11.035334 32.285311.638543 44.850487l80.46666 86.564541c11.680017 12.583596 30.356378 12.893658 41.662889.716314l377.434212-421.426145c11.332093-12.183484 11.041474-32.266891-.657986-44.844348l-80.46666-86.564541c-1.772366-1.910513-3.706415-3.533476-5.750981-4.877077L373.270379 71.774697c-11.777231-11.500939-30.216186-10.304694-41.178865 2.712784z"/></svg>
</i>
</a>
</nav>
</footer>
</article>
<div class="post bg-white">
<script src=https://utteranc.es/client.js repo=ZhuZhengyi/gh_comment issue-term=pathname theme=github-light crossorigin=anonymous async></script>
</div>
</div>
</div>
<div class=modal-dialog>
<div class=modal-content>
<div id=closeSearch title=Close class=close>X</div>
<div id=fastSearch>
<input id=searchInput tabindex=0>
<ul id=searchResults>
</ul>
</div>
</div>
</div>
</main>
<footer id=footer class=footer>
<div class=icon-links>
<a href=mailto:justice_103@126.com rel="me noopener" class=iconfont title=email><svg class="icon" viewBox="0 0 1451 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="36" height="36"><path d="M664.781909 681.472759.0 97.881301C0 3.997201 71.046997.0 71.046997.0H474.477909 961.649408h399.992405s71.046998 3.997201 71.046998 97.881301L771.345323 681.472759S764.482731 685.154773 753.594283 688.65053V688.664858C741.602731 693.493018 729.424896 695.068979 718.077952 694.839748 706.731093 695.068979 694.553173 693.493018 682.561621 688.664858V688.65053C671.644501 685.140446 664.781909 681.472759 664.781909 681.472759zm53.281707 130.131124C693.779541 811.016482 658.879232 802.205449 619.10784 767.734955 542.989056 701.759633.0 212.052267.0 212.052267V942.809523S0 1024 83.726336 1024H682.532949 753.579947h595.368192C1432.688811 1024 1432.688811 942.809523 1432.688811 942.809523V212.052267S893.138176 701.759633 817.019477 767.734955c-39.771477 34.470494-74.671786 43.295855-98.955861 43.868928z"/></svg>
</a>
<a href=https://justice.bj.cn/index.xml rel="noopener alternate" type=application/rss+xml class=iconfont title=rss target=_blank><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="30" height="30"><path d="M819.157333 1024C819.157333 574.592 449.408 204.8.0 204.8V0c561.706667.0 1024 462.293333 1024 1024H819.157333zM140.416 743.04a140.8 140.8.0 01140.501333 140.586667A140.928 140.928.0 01140.074667 1024C62.72 1024 0 961.109333.0 883.626667S62.933333 743.082667 140.416 743.04zM678.784 1024h-199.04c0-263.210667-216.533333-479.786667-479.744-479.786667v-199.04c372.352.0 678.784 306.517333 678.784 678.826667z"/></svg>
</a>
</div>
<div class=copyright>
<span class=power-by>
Powered by <a class=hexo-link href=https://gohugo.io>Hugo</a>
</span>
<span class=division>|</span>
<span class=theme-info>
Theme - <a class=theme-link href=https://github.com/xianmin/hugo-theme-jane>Jane</a>
</span>
<span class=copyright-year>
&copy;
2000 -
2024
<span class=heart>
<i class=iconfont><svg class="icon" viewBox="0 0 1025 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="14" height="14"><path d="M1000.1 247.9c-15.5-37.3-37.6-70.6-65.7-98.9-54.4-54.8-125.8-85-201-85-85.7.0-166 39-221.4 107.4C456.6 103 376.3 64 290.6 64c-75.1.0-146.5 30.4-201.1 85.6-28.2 28.5-50.4 61.9-65.8 99.3-16 38.8-24 79.9-23.6 122.2.7 91.7 40.1 177.2 108.1 234.8 3.1 2.6 6 5.1 8.9 7.8 14.9 13.4 58 52.8 112.6 102.7 93.5 85.5 209.9 191.9 257.5 234.2 7 6.1 15.8 9.5 24.9 9.5 9.2.0 18.1-3.4 24.9-9.5 34.5-30.7 105.8-95.9 181.4-165 74.2-67.8 150.9-138 195.8-178.2 69.5-57.9 109.6-144.4 109.9-237.3.1-42.5-8-83.6-24-122.2z" fill="#8a8a8a"/></svg>
</i>
</span><span class=author>
Justice
</span></span>
<span id=busuanzi_container>
访客数/访问量：<span id=busuanzi_value_site_uv></span>/<span id=busuanzi_value_site_pv></span>
</span>
</div>
</footer>
<div class=back-to-top id=back-to-top>
<i class=iconfont><svg class="icon" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="35" height="35"><path d="M510.866688 227.694839 95.449397 629.218702h235.761562L329.15309 958.01517h362.40389L691.55698 628.188232l241.942331-3.089361L510.866688 227.694839zM63.840492 63.962777h894.052392v131.813095H63.840492V63.962777zm0 0"/></svg>
</i>
</div>
</div>
<script type=text/javascript src=/lib/jquery/jquery-3.2.1.min.js></script>
<script type=text/javascript src=/lib/slideout/slideout-1.0.1.min.js></script>
<script type=text/javascript src=/js/main.638251f4230630f0335d8c6748e53a96f94b72670920b60c09a56fdc8bece214.js integrity="sha256-Y4JR9CMGMPAzXYxnSOU6lvlLcmcJILYMCaVv3Ivs4hQ=" crossorigin=anonymous></script>
<script type=text/javascript>window.MathJax={showProcessingMessages:!1,messageStyle:'none'}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML" async></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.css integrity=sha384-BdGj8xC2eZkQaxoQ8nSLefg4AV4/AwB3Fj+8SUSo7pnKP6Eoy18liIKTPn9oBYNG crossorigin=anonymous>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/katex.min.js integrity=sha384-JiKN5O8x9Hhs/UE5cT5AAJqieYlOZbGT3CHws/y97o3ty4R7/O5poG9F3JoiOYw1 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.0/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body)></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{})})</script>
<script type=text/javascript src=/js/load-photoswipe.js></script>
<script type=text/javascript src=/lib/photoswipe/photoswipe.min.js></script>
<script type=text/javascript src=/lib/photoswipe/photoswipe-ui-default.min.js></script>
<script async src=//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js></script>
<script>$("#search-btn").click(function(){$(".modal-dialog").addClass("visible")}),$("#closeSearch").click(function(){$(".modal-dialog").removeClass("visible")}),$(document).click(function(a){$(a.target).closest(".modal-content, #search-btn").length||$("body").find(".modal-dialog").removeClass("visible")})</script>
<script src=/js/fuse.min.js></script>
<script src=/js/fastsearch.js></script>
</body>
</html>